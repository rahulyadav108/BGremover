<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="description" content="Easily remove backgrounds and optimize images online with our free tool. Upload, preview, edit, and download compressed images easily.">
  <meta name="keywords" content="Background Remover, Image Editor, Photo Optimizer, Compress Images, Online Free Tool">
  <meta name="author" content="YourWebsiteName">
  <title>Background Remover & Optimizer | Free Tool</title>

  <!-- Tailwind CSS -->
  <script src="https://cdn.tailwindcss.com"></script>

  <script>
    tailwind.config = {
      theme: {
        extend: {
          colors: {
            primary: '#4F46E5',
            secondary: '#6366F1',
          }
        }
      }
    }
  </script>

  <style>
    body { font-family: 'Inter', sans-serif; }
    .image-preview img {
      max-width: 100%;
      border-radius: 1rem;
      margin-top: 1rem;
      box-shadow: 0 4px 10px rgba(0,0,0,0.1);
    }
  </style>
</head>

<body class="bg-gradient-to-br from-indigo-50 to-white min-h-screen flex flex-col">

  <!-- Header -->
  <header class="bg-white shadow-md sticky top-0 z-50">
    <div class="max-w-6xl mx-auto p-4 flex items-center justify-between">
      <h1 class="text-2xl font-bold text-primary">BG Remover & Optimizer</h1>
    </div>
  </header>

  <!-- Main Content -->
  <main class="flex-grow max-w-4xl mx-auto p-6">
    <!-- Upload Card -->
    <section class="bg-white rounded-2xl shadow-lg p-8 mt-10 animate-fade-in">
      <h2 class="text-2xl font-bold text-center text-primary mb-6">Upload and Remove Background</h2>
      
      <form id="imageForm" class="space-y-6">
        <div>
          <label class="block text-gray-700 font-semibold mb-2">Upload Image:</label>
          <input type="file" accept="image/*" id="imageInput" class="w-full border border-gray-300 rounded-lg p-3 focus:ring-2 focus:ring-primary" required>
        </div>

        <div>
          <label class="block text-gray-700 font-semibold mb-2">Compression Level:</label>
          <select id="compressionLevel" class="w-full border border-gray-300 rounded-lg p-3 focus:ring-2 focus:ring-primary">
            <option value="1">High Quality</option>
            <option value="0.8">Medium Quality</option>
            <option value="0.6">Low Quality</option>
          </select>
        </div>

        <button type="submit" class="w-full bg-primary hover:bg-secondary text-white font-semibold py-3 rounded-lg transition duration-300">
          Process Image
        </button>
      </form>
      
      <!-- Preview Area -->
      <div id="preview" class="image-preview"></div>
    </section>

    <!-- Output Section -->
    <section id="output" class="bg-white rounded-2xl shadow-lg p-8 text-center mt-10 animate-fade-in">
      <p class="text-gray-500">Your processed image will appear here.</p>
    </section>
  </main>

  <!-- Footer -->
  <footer class="bg-white text-center p-6 mt-16 text-gray-500 text-sm">
    Â© 2025 YourWebsiteName. All rights reserved.
  </footer>

  <!-- Animation -->
  <style>
    @keyframes fade-in {
      from {opacity: 0; transform: translateY(10px);}
      to {opacity: 1; transform: translateY(0);}
    }
    .animate-fade-in {
      animation: fade-in 0.8s ease-out;
    }
  </style>

  <!-- JS Logic -->
  <script>
    const imageInput = document.getElementById('imageInput');
    const imageForm = document.getElementById('imageForm');
    const preview = document.getElementById('preview');
    const output = document.getElementById('output');

    let originalImage = new Image();

    imageInput.addEventListener('change', function() {
      const file = this.files[0];
      if (file) {
        const reader = new FileReader();
        reader.onload = function(event) {
          originalImage.src = event.target.result;
          preview.innerHTML = `<img src="${event.target.result}" alt="Uploaded Image">`;
        };
        reader.readAsDataURL(file);
      }
    });

    imageForm.addEventListener('submit', function(e) {
      e.preventDefault();

      const compressionLevel = parseFloat(document.getElementById('compressionLevel').value);

      if (!originalImage.src) {
        alert('Please upload an image.');
        return;
      }

      output.innerHTML = '<p class="text-blue-500 font-semibold">Processing your image, please wait...</p>';

      originalImage.onload = function() {
        const canvas = document.createElement('canvas');
        const ctx = canvas.getContext('2d');
        canvas.width = originalImage.width;
        canvas.height = originalImage.height;
        ctx.drawImage(originalImage, 0, 0);

        const imageData = ctx.getImageData(0, 0, canvas.width, canvas.height);

        // New improved background removal
        for (let i = 0; i < imageData.data.length; i += 4) {
          const r = imageData.data[i];
          const g = imageData.data[i + 1];
          const b = imageData.data[i + 2];
          const brightness = (r + g + b) / 3;

          // If pixel is bright (near white), make it transparent
          if (brightness > 200) {
            imageData.data[i + 3] = 0;
          }
        }

        ctx.putImageData(imageData, 0, 0);

        const processedImage = canvas.toDataURL('image/png', compressionLevel);

        output.innerHTML = `
          <p class="text-green-600 font-semibold mb-4">Your optimized image is ready!</p>
          <img src="${processedImage}" alt="Processed Image" class="mb-6 shadow-lg rounded-2xl">
          <a href="${processedImage}" download="optimized-image.png" class="inline-block bg-green-500 hover:bg-green-600 text-white py-3 px-6 rounded-lg font-semibold transition">
            Download Image
          </a>
        `;
      };

      // Trigger loading immediately if already ready
      if (originalImage.complete) {
        originalImage.onload();
      }
    });
  </script>

</body>
</html>
